ClimaUtilities.jl Release Notes
===============================

v0.1.17
------

#### Changed signature for `OutputPathGenerator.detect_restart_file`. PR [#122](https://github.com/CliMA/ClimaUtilities.jl/pull/122)

The signature for `OutputPathGenerator.detect_restart_file` was changed. This
change is motivated by the fact that `OutputPathGenerator.detect_restart_file`
only makes sense with the `ActiveLinkStyle`. This led to a cumbersome usage in
downstream packages where `ActiveLinkStyle` had to be imported just to call
`detect_restart_file`.

The old signature was deprecated.

v0.1.16
------

### Bug fixes

- `Utils.isequispaced` is now more efficient: it fails fast and does not allocate
as much. More redundant allocations due to `Utils.isequispaced` were fixed.

- Reduced allocations in regridding. New method `read!`.
Existing `read` now returns a copy of the data when returning from the cache.
PR [#119](https://github.com/CliMA/ClimaUtilities.jl/pull/119)

### Features

#### Added `OutputPathGenerator.detect_restart_file`. PR [#120](https://github.com/CliMA/ClimaUtilities.jl/pull/120)

A new function, `OutputPathGenerator.detect_restart_file`, has been added to
help automatically locate the most recent restart file generated by a
simulation. This function is particularly useful when restarting simulations
from a previous checkpoint. It works with the `ActiveLinkStyle` and can be
customized to handle different restart file naming conventions and sorting
criteria.

v0.1.15
-------

### Features

#### Added support for composing input variables. PR [#105](https://github.com/CliMA/ClimaUtilities.jl/pull/105/)

This allows a list of `varnames` (and possibly `file_paths`) to be passed to
`TimeVaryingInput` or `SpaceVaryingInput`, along with a `compose_function` to
compose them, as so:

```julia
# Define the pointwise composing function we want, a simple sum in this case
compose_function = (x, y) -> x + y
# Define pre-processing function to convert units of input
unit_conversion_func = (data) -> 1000 * data

data_handler = TimeVaryingInputs.TimeVaryingInput("era5_example.nc",
                                        ["u", "v"],
                                        target_space,
                                        start_date = Dates.DateTime(2000, 1, 1),
                                        regridder_type = :InterpolationsRegridder,
                                        file_reader_kwargs = (; preprocess_func = unit_conversion_func),
                                        compose_function)
```

See the `TimeVaryingInput` or `DataHandler` docs "NetCDF file input" sections
for more details.

### Deprecations

`reference_date` was renamed to `start_date` and `t_start` was dropped from the
constructors for `DataHandler` and `TimeVaryingInput`.

These changes are due to the fact that these arguments should not be needed.

v0.1.14
-------

- Reduce floating point errors in times for DataHandling. PR
  [#101](https://github.com/CliMA/ClimaUtilities.jl/pull/101)

v0.1.13
-------

- Fix `show` for `LRUCache` (and `iterate` with a state). PR
  [#96](https://github.com/CliMA/ClimaUtilities.jl/pull/96)

v0.1.12
-------

- Add support for interpolating while "period filling". PR
  [#85](https://github.com/CliMA/ClimaUtilities.jl/pull/85)
- Add support for boundary conditions in interpolation. PR
  [#84](https://github.com/CliMA/ClimaUtilities.jl/pull/84)
- Increased allocations in regridding. `read!` method removed. PR
  [#84](https://github.com/CliMA/ClimaUtilities.jl/pull/84)

v0.1.11
------

- Reduced allocations in regridding. New method `read!`. PR
  [#83](https://github.com/CliMA/ClimaUtilities.jl/pull/83)

v0.1.10
------

- Reduced allocations in regridding. New method `regridded_snapshot!`. PR
  [#72](https://github.com/CliMA/ClimaUtilities.jl/pull/72)

v0.1.9
------

- Extensions are internally reorganized, removing precompilation errors. PR
  [#69](https://github.com/CliMA/ClimaUtilities.jl/pull/69)

v0.1.8
------

- `generate_output_path(..., ::ActiveLinkStyle)` now returns the folder instead
  of the link. Links are still being created and managed. PR
  [#63](https://github.com/CliMA/ClimaUtilities.jl/pull/63)

v0.1.7
------

- Fix compatibility with ClimaComms 0.6. PR [#54](https://github.com/CliMA/ClimaUtilities.jl/pull/54)

v0.1.6
-------
- `OutputPathGenerator` now tries to create an active link when one is not available but some data is already there [#50](https://github.com/CliMA/ClimaUtilities.jl/pull/50)
- Fix compatibility with ClimaCore 0.14. PR [#50](https://github.com/CliMA/ClimaUtilities.jl/pull/50)

v0.1.5
-------
- Support passing down regridder and file reader arguments from higher level constructors. PR [#40](https://github.com/CliMA/ClimaUtilities.jl/pull/40)

v0.1.4
-------
- Fix and test MPI compatibility. PRs [#33](https://github.com/CliMA/ClimaUtilities.jl/pull/33), [#37](https://github.com/CliMA/ClimaUtilities.jl/pull/37)
- Select default regridder type if multiple are available. PR [#32](https://github.com/CliMA/ClimaUtilities.jl/pull/32)

v0.1.3
-------
- Add `DataStructures` module containing `LRUCache` object. PR [#35](https://github.com/CliMA/ClimaUtilities.jl/pull/35)
- Add `OutputPathGenerator`. PR [#28](https://github.com/CliMA/ClimaLand.jl/pull/28)

[badge-ðŸ’¥breaking]: https://img.shields.io/badge/ðŸ’¥BREAKING-red.svg
