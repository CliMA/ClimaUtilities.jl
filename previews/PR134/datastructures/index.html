<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Data Structures · ClimaUtilities.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaUtilities.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaUtilities.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li class="is-active"><a class="tocitem" href>Data Structures</a><ul class="internal"><li><a class="tocitem" href="#LRUCache"><span><code>LRUCache</code></span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="../climaartifacts/">ClimaArtifacts</a></li><li><a class="tocitem" href="../inputs/">Space and Time Inputs</a></li><li><a class="tocitem" href="../filereaders/">FileReaders</a></li><li><a class="tocitem" href="../datahandling/">DataHandling</a></li><li><a class="tocitem" href="../regridders/">Regridders</a></li><li><a class="tocitem" href="../outputpathgenerator/">OutputPathGenerator</a></li><li><a class="tocitem" href="../timemanager/">TimeManager</a></li><li><a class="tocitem" href="../faqs/">Frequently Asked Questions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Data Structures</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Data Structures</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimaUtilities.jl/blob/main/docs/src/datastructures.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DataStructures"><a class="docs-heading-anchor" href="#DataStructures"><code>DataStructures</code></a><a id="DataStructures-1"></a><a class="docs-heading-anchor-permalink" href="#DataStructures" title="Permalink"></a></h1><p>The <code>DataStructures</code> module implements helpful data structures to be used by other ClimaUtilities.jl modules or external packages.</p><h2 id="LRUCache"><a class="docs-heading-anchor" href="#LRUCache"><code>LRUCache</code></a><a id="LRUCache-1"></a><a class="docs-heading-anchor-permalink" href="#LRUCache" title="Permalink"></a></h2><p><code>DataStructures</code> implements an <code>LRUCache</code>, which is used in both <code>DataHandlingExt</code> and <code>NCFileReaderExt</code>. <code>LRUCache</code> can be used to store pieces of information that need to be accessed multiple times and may be expensive to compute, such as regridded fields or loaded files. Instead of recomputing the values each time they&#39;re needed, the previously-computed information is saved in the cache and retrieved directly from it. To prevent the cache from growing so large that it takes up significant memory, the least-recently-used (LRU) scheme maintains a maximum cache size: every time adding an element to the cache would lead its size to grow larger thant the maximum allowed, the element that was accessed the least recently is deleted first.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All the methods supported by dictionaries are currently implemented. If you need one that is not implemented, please open an issue or a pull request.</p></div></div><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>In many ways, <code>LRUCache</code>s behave like Julia dictionaries. To use one, we first need to initialize the empty cache specifying types of keys and values and optionally the maximum allowed size:</p><pre><code class="language-julia hljs">import ClimaUtilities.DataStructures
cache = DataStructures.LRUCache{Int, Int}(; max_size = 128)</code></pre><p>Once we have the <code>cache</code>, we can access and insert elements with <code>get!</code>. <code>get!</code> retrieves the value associated to the key if avaialble, otherwise it inserts a new key with a provided default. The default can be passed as third argument or can be the return statement of a function provided as first (as typically done in <code>do</code> blocks). Continuing the example above</p><pre><code class="language-julia hljs">println(&quot;The value associated to 1 is: &quot;, get!(cache, 1, 10))
other_value = get!(cache, 2) do
    return 20
end</code></pre><p>This cache can be used to implement some recursive function more efficiently, as in the famous case of the factorial:</p><pre><code class="language-julia hljs">function factorial(n)
    n in (0, 1) &amp;&amp; return 1
    return n * get!(cache, n - 1, factorial(n - 1))
end
# The first time we call factorial it will compute everything
@time factorial(10)
# The second time it will only compute the last element
@time factorial(11)</code></pre><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.DataStructures.LRUCache" href="#ClimaUtilities.DataStructures.LRUCache"><code>ClimaUtilities.DataStructures.LRUCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LRUCache{K, V}(; max_size::Int = 128) where {K, V}</code></pre><p>Construct an empty <code>LRUCache</code> with a maximum size of <code>max_size</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L34-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.get!" href="#Base.get!"><code>Base.get!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.get!(cache::LRUCache{K, V}, key::K, default::V) where {K, V}</code></pre><p>Get the value associated with <code>key</code> in <code>cache</code>. If the key is not in the cache, add it with the value <code>default</code>. In any case, update the key&#39;s priority and make sure the cache doesn&#39;t exceed its maximum size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L66-L72">source</a></section><section><div><pre><code class="nohighlight hljs">Base.get!(default::Callable, cache::LRUCache{K, V}, key::K) where {K, V}</code></pre><p>Get the value associated with <code>key</code> in <code>cache</code>. If the key is not in the cache, add it with the value <code>default()</code>. In any case, update the key&#39;s priority and make sure the cache doesn&#39;t exceed its maximum size.</p><p>This method is intended to be used with <code>do</code> block syntax.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L79-L87">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.get" href="#Base.get"><code>Base.get</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.get(cache::LRUCache{K, V}, key::K, default::V)</code></pre><p>Return the value associated with <code>key</code> in <code>cache</code>, or if <code>key</code> is not in <code>cache</code>, return <code>default</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L136-L141">source</a></section><section><div><pre><code class="nohighlight hljs">Base.get(default::Callable, cache::LRUCache{K, V}, key::K)</code></pre><p>Return the value associated with <code>key</code> in <code>cache</code>, or if the key is not in the cache, return <code>f()</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L147-L152">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.haskey" href="#Base.haskey"><code>Base.haskey</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.haskey(cache::LRUCache{K, V}, key::K)</code></pre><p>Return whether <code>key</code> has a mapping in <code>cache</code>. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L158-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.copy" href="#Base.copy"><code>Base.copy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.copy(cache::LRUCache{K, V})</code></pre><p>Return a shallow copy of <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L167-L171">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.deepcopy" href="#Base.deepcopy"><code>Base.deepcopy</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.deepcopy(cache::LRUCache{K, V})</code></pre><p>Return a deep copy of <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L180-L184">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.empty" href="#Base.empty"><code>Base.empty</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.empty(cache::LRUCache{K, V}, key_type::DataType=K, value_type::DataType=V)</code></pre><p>Create an empty <code>LRUCache</code> with keys of type <code>key_type</code> and values of type <code>value_type</code>.</p><p>The second and third arguments are optional and default to the input&#39;s <code>keytype</code> and <code>valuetype</code>.  If only one of the two type is specified, it is assumed to be the <code>value_type</code>, and <code>key_type</code> is  assumed to the key type of <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L193-L201">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.empty!" href="#Base.empty!"><code>Base.empty!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.empty!(cache::LRUCache{K, V})</code></pre><p>Remove all key/value mappings from the input and return the emptied input.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L217-L221">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.pop!" href="#Base.pop!"><code>Base.pop!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.pop!(cache::LRUCache{K, V}, key::K, [default::V])</code></pre><p>Delete the mapping for <code>key</code> in <code>cache</code> and return the associated <code>value</code>, or  if the <code>key</code> does not exist, return <code>default</code> or throw an error if <code>default</code> is not specified</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L228-L233">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.delete!" href="#Base.delete!"><code>Base.delete!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.delete!(cache::LRUCache{K, V}, key::K)</code></pre><p>Delete mapping for <code>key</code>, if it is in<code>cache</code>, and return <code>cache</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L246-L250">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.getindex" href="#Base.getindex"><code>Base.getindex</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.getindex(cache::LRUCache{K, V}, key::K)</code></pre><p>Return the mapping for <code>key</code> in <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L55-L59">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.setindex!" href="#Base.setindex!"><code>Base.setindex!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.setindex!(cache::LRUCache{K, V}, value::V, key::K)</code></pre><p>Store the mapping from <code>key</code> to <code>value</code> in <code>cache</code>. Then, return <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length" href="#Base.length"><code>Base.length</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.length(cache::LRUCache{K, V})</code></pre><p>Return the number of elements in <code>cache</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/de3ce9bdf6ceafb98e148f5032c89b9a85f5de28/src/DataStructures.jl#L98-L102">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Overview</a><a class="docs-footer-nextpage" href="../climaartifacts/">ClimaArtifacts »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Wednesday 27 November 2024 23:43">Wednesday 27 November 2024</span>. Using Julia version 1.10.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
