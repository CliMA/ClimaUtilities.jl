<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DataStructures · ClimaUtilities.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaUtilities.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaUtilities.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../climaartifacts/">ClimaArtifacts</a></li><li><a class="tocitem" href="../inputs/">Space and Time Inputs</a></li><li><a class="tocitem" href="../filereaders/">FileReaders</a></li><li><a class="tocitem" href="../datahandling/">DataHandling</a></li><li><a class="tocitem" href="../regridders/">Regridders</a></li><li><a class="tocitem" href="../outputpathgenerator/">OutputPathGenerator</a></li><li><a class="tocitem" href="../timemanager/">TimeManager</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href><code>DataStructures</code></a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href><code>DataStructures</code></a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimaUtilities.jl/blob/main/docs/src/datastructures.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="DataStructures"><a class="docs-heading-anchor" href="#DataStructures"><code>DataStructures</code></a><a id="DataStructures-1"></a><a class="docs-heading-anchor-permalink" href="#DataStructures" title="Permalink"></a></h1><p>The <code>DataStructures</code> module implements helpful data structures to be used by other ClimaUtilities.jl modules or external packages.</p><h2 id="LRUCache"><a class="docs-heading-anchor" href="#LRUCache"><code>LRUCache</code></a><a id="LRUCache-1"></a><a class="docs-heading-anchor-permalink" href="#LRUCache" title="Permalink"></a></h2><p><code>DataStructures</code> implements an <code>LRUCache</code>, which is used in both <code>DataHandlingExt</code> and <code>NCFileReaderExt</code>. <code>LRUCache</code> can be used to store pieces of information that need to be accessed multiple times and may be expensive to compute, such as regridded fields or loaded files. Instead of recomputing the values each time they&#39;re needed, the previously-computed information is saved in the cache and retrieved directly from it. To prevent the cache from growing so large that it takes up significant memory, the least-recently-used (LRU) scheme maintains a maximum cache size: every time adding an element to the cache would lead its size to grow larger thant the maximum allowed, the element that was accessed the least recently is deleted first.</p><blockquote><p>Note: all the methods supported by dictionaries are currently implemented.</p></blockquote><p>If you need one that is not implemented, please open an issue or a pull request.</p><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>In many ways, <code>LRUCache</code>s behave like Julia dictionaries. To use one, we first need to initialize the empty cache specifying types of keys and values and optionally the maximum allowed size:</p><pre><code class="language-julia hljs">import ClimaUtilities.DataStructures
cache = DataStructures.LRUCache{Int, Int}(; max_size = 128)</code></pre><p>Once we have the <code>cache</code>, we can access and insert elements with <code>get!</code>. <code>get!</code> retrieves the value associated to the key if avaialble, otherwise it inserts a new key with a provided default. The default can be passed as third argument or can be the return statement of a function provided as first (as typically done in <code>do</code> blocks). Continuing the example above</p><pre><code class="language-julia hljs">println(&quot;The value associated to 1 is: &quot;, get!(cache, 1, 10))
other_value = get!(cache, 2) do
    return 20
end</code></pre><p>This cache can be used to implement some recursive function more efficiently, as in the famous case of the factorial:</p><pre><code class="language-julia hljs">function factorial(n)
    n in (0, 1) &amp;&amp; return 1
    return n * get!(cache, n - 1, factorial(n - 1))
end
# The first time we call factorial it will compute everything
@time factorial(10)
# The second time it will only compute the last element
@time factorial(11)</code></pre><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.DataStructures.LRUCache" href="#ClimaUtilities.DataStructures.LRUCache"><code>ClimaUtilities.DataStructures.LRUCache</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LRUCache{K, V}(; max_size::Int = 128) where {K, V}</code></pre><p>Construct an empty <code>LRUCache</code> with a maximum size of <code>max_size</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/2a8d9f46a0e8ef10c183946f8f572d84b56c0227/src/DataStructures.jl#L34-L38">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.get!" href="#Base.get!"><code>Base.get!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">Base.get!(cache::LRUCache{K, V}, key::K, default::V) where {K, V}</code></pre><p>Get the value associated with <code>key</code> in <code>cache</code>. If the key is not in the cache, add it with the value <code>default</code>. In any case, update the key&#39;s priority and make sure the cache doesn&#39;t exceed its maximum size.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/2a8d9f46a0e8ef10c183946f8f572d84b56c0227/src/DataStructures.jl#L43-L49">source</a></section><section><div><pre><code class="nohighlight hljs">Base.get!(default::Callable, cache::LRUCache{K, V}, key::K) where {K, V}</code></pre><p>Get the value associated with <code>key</code> in <code>cache</code>. If the key is not in the cache, add it with the value <code>default()</code>. In any case, update the key&#39;s priority and make sure the cache doesn&#39;t exceed its maximum size.</p><p>This method is intended to be used with <code>do</code> block syntax.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/2a8d9f46a0e8ef10c183946f8f572d84b56c0227/src/DataStructures.jl#L56-L64">source</a></section></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Tuesday 30 April 2024 22:45">Tuesday 30 April 2024</span>. Using Julia version 1.10.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
