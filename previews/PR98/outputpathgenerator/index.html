<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>OutputPathGenerator · ClimaUtilities.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaUtilities.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaUtilities.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../climaartifacts/">ClimaArtifacts</a></li><li><a class="tocitem" href="../inputs/">Space and Time Inputs</a></li><li><a class="tocitem" href="../filereaders/">FileReaders</a></li><li><a class="tocitem" href="../datahandling/">DataHandling</a></li><li><a class="tocitem" href="../regridders/">Regridders</a></li><li class="is-active"><a class="tocitem" href>OutputPathGenerator</a><ul class="internal"><li><a class="tocitem" href="#Available-Styles"><span>Available Styles</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="../timemanager/">TimeManager</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>OutputPathGenerator</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>OutputPathGenerator</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimaUtilities.jl/blob/main/docs/src/outputpathgenerator.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="OutputPathGenerator"><a class="docs-heading-anchor" href="#OutputPathGenerator"><code>OutputPathGenerator</code></a><a id="OutputPathGenerator-1"></a><a class="docs-heading-anchor-permalink" href="#OutputPathGenerator" title="Permalink"></a></h1><p>The <code>OutputPathGenerator</code> module provides tools for preparing the directory structure for your simulation output. This helps you organize your simulation results efficiently and avoid overwriting existing data.</p><p>The module offers one function, <code>generate_output_path</code>. The function takes three arguments:</p><ul><li><code>output_path</code>: The base directory path for your simulation output.</li><li><code>style</code> (Optional): The desired style for output management (defaults to <code>ActiveLinkStyle</code>).</li><li><code>context</code> (Optional): the <code>ClimaComms.context</code>. This is required in MPI runs to ensure that all the MPI processes agree on the folder structure.</li></ul><p>The function processes the <code>output_path</code> based on the chosen style and returns the final path where you should write your simulation output.</p><p>You should use <code>generate_output_path</code> at the beginning of your simulation and use the return value as the base directory where you save all the output your code produces.</p><h2 id="Available-Styles"><a class="docs-heading-anchor" href="#Available-Styles">Available Styles</a><a id="Available-Styles-1"></a><a class="docs-heading-anchor-permalink" href="#Available-Styles" title="Permalink"></a></h2><p>The module currently offers two different styles for handling the output directory:</p><h3 id="RemovePreexistingStyle-(Destructive)"><a class="docs-heading-anchor" href="#RemovePreexistingStyle-(Destructive)"><code>RemovePreexistingStyle</code> (Destructive)</a><a id="RemovePreexistingStyle-(Destructive)-1"></a><a class="docs-heading-anchor-permalink" href="#RemovePreexistingStyle-(Destructive)" title="Permalink"></a></h3><p>This style directly uses the provided output_path as the final output directory. Important: If a directory already exists at the specified path, it will be removed completely (including any subfolders and files) without confirmation. Use this style cautiously!</p><h3 id="ActiveLinkStyle-(Non-Destructive)"><a class="docs-heading-anchor" href="#ActiveLinkStyle-(Non-Destructive)"><code>ActiveLinkStyle</code> (Non-Destructive)</a><a id="ActiveLinkStyle-(Non-Destructive)-1"></a><a class="docs-heading-anchor-permalink" href="#ActiveLinkStyle-(Non-Destructive)" title="Permalink"></a></h3><p>This style provides a more convenient and non-destructive approach. It manages a sequence of subfolders within the base directory specified by output<em>path. It also creates a symbolic link named `output</em>active` that points to the current active subfolder. This allows you to easily access the latest simulation results.</p><h4 id="Example"><a class="docs-heading-anchor" href="#Example"><code>Example</code></a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h4><p>Let&#39;s assume your <code>output_path</code> is set to <code>data</code>.</p><ul><li>If <code>data</code> doesn&#39;t exist, the module creates it and returns <code>data/output_0000</code>. In doing this, a link <code>data/output_active</code> to <code>data/output_0000</code> is created so that you can always access your data in <code>data/output_active</code>.</li><li>If <code>data</code> exists and contains an <code>output_active</code> link pointing to <code>data/output_0005</code>, <code>output_active</code> is updated to point to a new subfolder called <code>data/output_0006</code></li><li>If <code>data</code> exists with or without an <code>output_active</code> link, the module checks for existing subfolders named <code>data/output_XXXX</code> (with <code>XXXX</code> a number). If none are found, it creates <code>data/output_0000</code> and a link <code>data/output_active</code> pointing to it.</li></ul><h4 id="A-note-for-Windows-users"><a class="docs-heading-anchor" href="#A-note-for-Windows-users">A note for Windows users</a><a id="A-note-for-Windows-users-1"></a><a class="docs-heading-anchor-permalink" href="#A-note-for-Windows-users" title="Permalink"></a></h4><p>Windows does not always allow the creation of symbolic links by unprivileged users, so some details about links might be slightly different depending on your system. If you are using Windows, please have a look at docstring on the <code>ActiveLinkStyle</code> to learn more about possible differences.</p><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.OutputPathGenerator.generate_output_path" href="#ClimaUtilities.OutputPathGenerator.generate_output_path"><code>ClimaUtilities.OutputPathGenerator.generate_output_path</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">generate_output_path(output_path,
                     context = nothing,
                     style::OutputPathGeneratorStyle = ActiveLinkStyle())</code></pre><p>Process the <code>output_path</code> and return a string with the path where to write the output.</p><p>The <code>context</code> is a <code>ClimaComms</code> context and is required for MPI runs.</p><p>How the output should be structured (in terms of directory tree) is determined by the <code>style</code>.</p><p><strong>Styles</strong></p><ul><li><p><code>RemovePreexistingStyle</code>: the <code>output_path</code> provided is the actual output path. If a directory already exists there, remove it without asking for confirmation.</p></li><li><p><code>ActiveLinkStyle</code>: the <code>output_path</code> returned is a new folder of the form <code>output_path/output_1234</code>, where the number is incremented every time this function is called. <code>ActiveLinkStyle</code> also creates a link <code>output_path/output_active</code> that ensures that the most recent output is always accessible at the <code>output_path/output_active</code> path. This is style is non-destructive.</p></li></ul><p>(Note, &quot;styles&quot; have nothing to do with Julia traits.)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/9e2669ea6a42c0d6bf0c144a15b75337ae898ad4/src/OutputPathGenerator.jl#L103-L127">source</a></section><section><div><pre><code class="nohighlight hljs">generate_output_path(::RemovePreexistingStyle, output_path, context = nothing)</code></pre><p>Documentation for this function is in the <code>RemovePreexistingStyle</code> struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/9e2669ea6a42c0d6bf0c144a15b75337ae898ad4/src/OutputPathGenerator.jl#L137-L141">source</a></section><section><div><pre><code class="nohighlight hljs">generate_output_path(::ActiveLinkStyle, output_path, context = nothing)</code></pre><p>Documentation for this function is in the <code>ActiveLinkStyle</code> struct.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/9e2669ea6a42c0d6bf0c144a15b75337ae898ad4/src/OutputPathGenerator.jl#L159-L163">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.OutputPathGenerator.RemovePreexistingStyle" href="#ClimaUtilities.OutputPathGenerator.RemovePreexistingStyle"><code>ClimaUtilities.OutputPathGenerator.RemovePreexistingStyle</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">RemovePreexistingStyle</code></pre><p>With this option, the output directory is directly specified. If the directory already exists, remove it. No confirmation is asked, so use at your own risk.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/9e2669ea6a42c0d6bf0c144a15b75337ae898ad4/src/OutputPathGenerator.jl#L51-L56">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.OutputPathGenerator.ActiveLinkStyle" href="#ClimaUtilities.OutputPathGenerator.ActiveLinkStyle"><code>ClimaUtilities.OutputPathGenerator.ActiveLinkStyle</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ActiveLinkStyle</code></pre><p>This style generates a unique output path within a base directory specified by <code>output_path</code>. It ensures the base directory exists and creates it if necessary. Additionally, it manages a sequence of subfolders and a symbolic link named &quot;output_active&quot; for convenient access to the active output location.</p><p>This style is designed to:</p><ul><li>be non-destructive,</li><li>provide a deterministic and fixed path for the latest available data,</li><li>and have nearly zero runtime overhead.</li></ul><p><code>generate_output_path</code> returns path to the newly created folder with the next available increment (of the form <code>output_1234</code>), and ensures that a valid <code>output_active</code> link points to that folder.</p><p><strong>Examples:</strong></p><p>Let us assume that <code>output_path = dormouse</code>.</p><ul><li><code>dormouse</code> does not exist in the current working directory: <code>ActiveLinkStyle</code> will create it and return <code>dormouse/output_0000</code>. In the process, a symlink <code>dormouse/output_active</code> is also created. This symlink points to <code>dormouse/output_0000</code>.</li><li><code>dormouse</code> exists and contains a <code>output_active</code> link that points to <code>dormouse/output_0005</code>, <code>ActiveLinkStyle</code> will a create new directory <code>dormouse/output_0006</code>, return this path, and change the <code>output_active</code> to point to this directory.</li><li><code>dormouse</code> exists and does not contain a <code>output_active</code>, <code>ActiveLinkStyle</code> will check if any <code>dormouse/output_XXXX</code> exists. If not, it creates <code>dormouse/output_0000</code> and a link <code>dormouse/output_active</code> that points to this directory.</li></ul><p><strong>A note for Windows users</strong></p><p>Windows does not always allow the creation of symbolic links by unprivileged users. This depends on the version of Windows, but also some of its settings. When the creation of symbolic links is not possible, <code>OutputPathGenerator</code> will create NTFS junction points instead. Junction points are similar to symbolic links, with the main difference that they have to refer to directories and they have to be absolute paths. As a result, on systems that do not allow unprivileged users to create symbolic links, moving the base output folder results in breaking the <code>output_active</code> link.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/9e2669ea6a42c0d6bf0c144a15b75337ae898ad4/src/OutputPathGenerator.jl#L59-L100">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../regridders/">« Regridders</a><a class="docs-footer-nextpage" href="../timemanager/">TimeManager »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Saturday 17 August 2024 05:34">Saturday 17 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
