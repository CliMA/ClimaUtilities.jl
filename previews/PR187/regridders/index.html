<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Regridders · ClimaUtilities.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.svg" alt="ClimaUtilities.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">ClimaUtilities.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Overview</a></li><li><a class="tocitem" href="../datastructures/">Data Structures</a></li><li><a class="tocitem" href="../climaartifacts/">ClimaArtifacts</a></li><li><a class="tocitem" href="../inputs/">Space and Time Inputs</a></li><li><a class="tocitem" href="../filereaders/">FileReaders</a></li><li><a class="tocitem" href="../datahandling/">DataHandling</a></li><li class="is-active"><a class="tocitem" href>Regridders</a><ul class="internal"><li><a class="tocitem" href="#tempest_regridder"><span><code>TempestRegridder</code></span></a></li><li><a class="tocitem" href="#interp_regridder"><span><code>InterpolationsRegridder</code></span></a></li><li><a class="tocitem" href="#FAQ:-How-do-I-enable-linear-extrapolation-in-z?"><span>FAQ: How do I enable linear extrapolation in z?</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li><li><a class="tocitem" href="../onlinelogging/">OnlineLogging</a></li><li><a class="tocitem" href="../outputpathgenerator/">OutputPathGenerator</a></li><li><a class="tocitem" href="../timemanager/">TimeManager</a></li><li><a class="tocitem" href="../faqs/">Frequently Asked Questions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Regridders</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Regridders</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/CliMA/ClimaUtilities.jl/blob/main/docs/src/regridders.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="regridder_module"><a class="docs-heading-anchor" href="#regridder_module"><code>Regridders</code></a><a id="regridder_module-1"></a><a class="docs-heading-anchor-permalink" href="#regridder_module" title="Permalink"></a></h1><p>Simulations often need to import external data directly onto the computational grid. The <code>Regridders</code> module implements different schemes to accomplish this goal.</p><p>Currently, <code>Regridders</code> comes with two implementations:</p><ol><li><code>TempestRegridder</code> uses <a href="https://github.com/ClimateGlobalChange/tempestremap">TempestRemap</a> (through <code>ClimaCoreTempestRemap</code>) to perform conservative interpolation onto lat-long grids. <code>TempestRegridder</code> only works for single-threaded CPU runs and works directly with files.</li><li><code>InterpolationsRegridder</code> uses <a href="https://github.com/JuliaMath/Interpolations.jl">Interpolations.jl</a> to perform non-conservative linear interpolation onto lat-long(-z) and x-y-z grids. <code>InterpolationsRegridder</code> works directly with data.</li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>While the <code>Regridders</code> can be used independently, most users will find their needs are immediately met by the <a href="../#SpaceVaryingInputs-and-TimeVaryingInputs"><code>SpaceVaryingInputs</code> and <code>TimeVaryingInputs</code></a> interfaces. These higher-level objects implement everything that is needed to read a file to the model grid (internally using the <code>Regridders</code>).</p></div></div><p>If a regridder type is not specified by the user, and multiple are available, the <code>InterpolationsRegridder</code> will be used by default. At least one regridder extension must be loaded to be able to use regridding.</p><h2 id="tempest_regridder"><a class="docs-heading-anchor" href="#tempest_regridder"><code>TempestRegridder</code></a><a id="tempest_regridder-1"></a><a class="docs-heading-anchor-permalink" href="#tempest_regridder" title="Permalink"></a></h2><blockquote><p>This extension is loaded when loading <code>ClimaCoreTempestRemap</code></p></blockquote><p><code>TempestRegridder</code> performs conservative interpolation of lat-lon grids onto computational domains. <code>TempestRegridder</code> performs all the interpolation ahead of time and saves the regridded fields to HDF5 files that can be read during the simulation.</p><p>Currently, <code>TempestRegridder</code> does not support regridding on 3D domains. The <code>InterpolationsRegridder</code> described below can be used for these cases.</p><h3 id="Example"><a class="docs-heading-anchor" href="#Example">Example</a><a id="Example-1"></a><a class="docs-heading-anchor-permalink" href="#Example" title="Permalink"></a></h3><p>Assuming <code>target_space</code> is a <code>ClimaCore</code> 2D spherical field, the input data is the variable <code>u</code> in the file <code>era5_example.nc</code>, and we want to read the data associated with date <code>target_date</code>.</p><pre><code class="language-julia hljs">import ClimaUtilities.Regridders
import ClimaCoreTempestRemap
# Loading ClimaCoreTempest automatically loads TempestRegridder

reg = Regridders.TempestRegridder(target_space, &quot;regrid_output&quot;, &quot;u&quot;, &quot;era5_example.nc&quot;)
# When reg is created, the variable `u` is regridded and the output files
# are saved to the `regrid_output` folder

regridded_u = Regridders.regrid(reg, target_date)</code></pre><h2 id="interp_regridder"><a class="docs-heading-anchor" href="#interp_regridder"><code>InterpolationsRegridder</code></a><a id="interp_regridder-1"></a><a class="docs-heading-anchor-permalink" href="#interp_regridder" title="Permalink"></a></h2><blockquote><p>This extension is loaded when loading <code>ClimaCore</code> and <code>Interpolations</code></p></blockquote><p><code>InterpolationsRegridder</code> performs linear interpolation of input data (linear along each direction) and returns a <code>ClimaCore</code> <code>Field</code> defined on the <code>target_space</code>.</p><div class="admonition is-info"><header class="admonition-header">Did you know?</header><div class="admonition-body"><p>With versions of ClimaUtilities after v0.1.24, you can choose the mode of the gridded interpolation with the keyword argument <code>interpolation_method</code>. For example, to do constant interpolation, you can pass <code>interpolation_method = Interpolations.Constant()</code> as a keyword argument when constructing the regridder.</p></div></div><p>Currently, <code>InterpolationsRegridder</code> only supports spherical shells and extruded spherical shells (but it could be easily extended to other domains).</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is easy to change the spatial interpolation type if needed.</p></div></div><p><code>InterpolationsRegridder</code> are created once, they are tied to a <code>target_space</code>, but can be used with any input data. With MPI runs, every process computes the interpolating function. This is always done on the CPU and moved to GPU for accelerated runs.</p><p>By default, <code>InterpolationsRegridder</code> assumes you are interpolating on a globe and the default extrapolation boundary conditions are: periodic (along longitudes), copy (along latitude), and throwing an error (along z). These can be changed by passing the <code>extrapolation_bc</code> to the constructor of the regridder.</p><h2 id="FAQ:-How-do-I-enable-linear-extrapolation-in-z?"><a class="docs-heading-anchor" href="#FAQ:-How-do-I-enable-linear-extrapolation-in-z?">FAQ: How do I enable linear extrapolation in z?</a><a id="FAQ:-How-do-I-enable-linear-extrapolation-in-z?-1"></a><a class="docs-heading-anchor-permalink" href="#FAQ:-How-do-I-enable-linear-extrapolation-in-z?" title="Permalink"></a></h2><p>Create the regridder like this:</p><pre><code class="language-julia hljs">import Interpolations as Intp

extrapolation_bc = (Intp.Periodic(), Intp.Flat(), Intp.Linear())
regridder = InterpolationsRegridder(target_space; extrapolation_bc)</code></pre><h3 id="Example-2"><a class="docs-heading-anchor" href="#Example-2">Example</a><a class="docs-heading-anchor-permalink" href="#Example-2" title="Permalink"></a></h3><p>Assuming <code>target_space</code> is a <code>ClimaCore</code> 2D spherical field.</p><pre><code class="language-julia hljs">import ClimaUtilities.Regridders
import ClimaCore, Interpolations
# Loading ClimaCore and Interpolations automatically loads InterpolationsRegridder

reg = Regridders.InterpolationsRegridder(target_space)

# Now we can regrid any data
lon = collect(-180:1:180)
lat = collect(-90:1:90)
# It has to be lon, lat (because this is the assumed order in the CF conventions)
dimensions = (lon, lat)

data = rand((length(lon), length(lat)))

interpolated_data = Regridders.InterpolationsRegridder(reg, data, dimensions)
interpolated_2data = Regridders.InterpolationsRegridder(reg, 2 .* data, dimensions)</code></pre><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.Regridders.TempestRegridder" href="#ClimaUtilities.Regridders.TempestRegridder"><code>ClimaUtilities.Regridders.TempestRegridder</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">TempestRegridder(target_space::ClimaCore.Spaces.AbstractSpace,
                 varname::AbstractString,
                 input_file::AbstractString;
                 regrid_dir::AbstractString,
                 mono::Bool)</code></pre><p>Set up a <code>TempestRegridder</code> object to regrid the variable in the given <code>input_file</code> to the <code>target_space</code>. <code>TempestRegridder</code> works only on CPU and on a single process.</p><p><strong>Positional arguments</strong></p><ul><li><code>target_space</code>: the ClimaCore Space where the simulation is being performed.</li><li><code>input_file</code>: the path of the NetCDF file that has to be read and processed.</li><li><code>regrid_dir</code>: the path where to save the regrid files created by TempestRemap.</li><li><code>varname</code>: the name of the variable in the NetCDF file.</li><li><code>regrid_dir</code>: a folder where regridded Fields are saved as HDF5 files.</li></ul><p><strong>Keyword arguments</strong></p><ul><li><code>mono</code>: Whether remapping has to be monotonic or not.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/245f4f30649fab56541951b6e62c12c404095f2e/ext/TempestRegridderExt.jl#L43-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.Regridders.InterpolationsRegridder" href="#ClimaUtilities.Regridders.InterpolationsRegridder"><code>ClimaUtilities.Regridders.InterpolationsRegridder</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">InterpolationsRegridder(target_space::ClimaCore.Spaces.AbstractSpace
                        [; extrapolation_bc::Tuple,
                           dim_increasing::Union{Nothing, Tuple},
                           interpolation_method = Interpolations.Linear()])</code></pre><p>An online regridder that uses Interpolations.jl</p><p>Currently, InterpolationsRegridder is only implemented for LatLong and LatLongZ spaces. It performs linear interpolation along each of the directions (separately). By default, it imposes periodic boundary conditions for longitude, flat for latitude, and throwing errors when extrapolating in z. This can be customized by passing the <code>extrapolation_bc</code> keyword argument.</p><p>InterpolationsRegridder is GPU and MPI compatible in the simplest possible way: each MPI process has the entire input data and everything is copied to GPU.</p><p><strong>Keyword arguments</strong></p><p>The optional keyword argument <code>extrapolation_bc</code> controls what should be done when the interpolation point is not in the domain of definition. This has to be a tuple of N elements, where N is the number of spatial dimensions. For 3D spaces, the default is <code>(Interpolations.Periodic(), Interpolations.Flat(), Interpolations.Throw())</code>.</p><p>The optional keyword argument <code>dim_increasing</code> controls which dimensions should be reversed before performing interpolation. This must be a tuple of N booleans, where N is the number of spatial dimensions. The default is the <code>true</code> for each spatial dimension.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/245f4f30649fab56541951b6e62c12c404095f2e/ext/InterpolationsRegridderExt.jl#L42-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ClimaUtilities.Regridders.regrid" href="#ClimaUtilities.Regridders.regrid"><code>ClimaUtilities.Regridders.regrid</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">regrid(regridder::TempestRegridder, date::Dates.DateTime)</code></pre><p>Return the field associated to the <code>regridder</code> at the given <code>date</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/245f4f30649fab56541951b6e62c12c404095f2e/ext/TempestRegridderExt.jl#L108-L112">source</a></section><section><div><pre><code class="nohighlight hljs">regrid(regridder::InterpolationsRegridder, data, dimensions)::Field</code></pre><p>Regrid the given data as defined on the given dimensions to the <code>target_space</code> in <code>regridder</code>.</p><p>This function is allocating.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CliMA/ClimaUtilities.jl/blob/245f4f30649fab56541951b6e62c12c404095f2e/ext/InterpolationsRegridderExt.jl#L105-L111">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../datahandling/">« DataHandling</a><a class="docs-footer-nextpage" href="../onlinelogging/">OnlineLogging »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 29 September 2025 18:37">Monday 29 September 2025</span>. Using Julia version 1.10.10.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
